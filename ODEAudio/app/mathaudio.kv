#:kivy 2.1.0

<MathAudioApplet>:
    # img: img

    # BG image
    # Image:
    #     id: img
    #     pos: 0, 0
    #     width: root.width/2
    #     height: root.height
    #     allow_stretch: True

    canvas:
        # GUI Frame
        Color:
            rgba: .6, .6, .6, .8

        Line:
            points: ((0, root.height/2), (root.width, root.height/2))
            width: 1

        Line:
            points: ((root.width/2, 0), (root.width/2, root.height))
            width: 1

        Color:
            rgba: 1,1,1,.6

        Rectangle:
            # This source file is created at init time
            source: 'bg_left.png'
            pos: 0, root.height * 0.2
            size: root.width/2, root.height * 0.8

        Color:
            rgba: 0, 1, 0, .6

        # Guides for cA/cB
        Ellipse:
            pos: self.cCursor[0] - 5, self.cCursor[1] - 5
            size: 10, 10

        Line:
            points: self.cPoints1
            width: 1.414

        Line:
            points: self.cPoints2
            width: 1.414

        Line:
            points: self.cPoints3
            width: 1.414

        # Guides for eA/eB
        Ellipse:
            pos: self.eCursor[0] - 5, self.eCursor[1] - 5
            size: 10, 10

        Line:
            points: self.ePoints1
            width: 1.414

        Line:
            points: self.ePoints2
            width: 1.414

        Line:
            points: self.ePoints3
            width: 1.414

        # Selection rectangle
        Color:
            rgba: 1, 1, 1, 1

        Line:
            points: (self.select_start, (self.select_start[0], self.select_end[1]), self.select_end, (self.select_end[0], self.select_start[1]), self.select_start)
            width: 1

        ## Channel frequencies
        # Clear area
        Color:
            rgba: 0, 0, 0, 1

        Rectangle:
            pos: 0, 0
            size: root.width, root.height * 0.2

        # Highlight L/R channel
        Color:
            rgba: 0.5, 0, 0, 0.5

        Rectangle:
            pos: self.lChan * root.width * 0.2, 0
            size: root.width * 0.2, root.height * 0.2

        Color:
            rgba: 0, 0.4, 0.2, 0.5

        Rectangle:
            pos: self.rChan * root.width * 0.2, 0
            size: root.width * 0.2, root.height * 0.2

        # Draw traces
        Color:
            rgba: .4, .4, .4, .5

        Line:
            points: self.points0
            width: 2
        Line:
            points: self.points1
            width: 2
        Line:
            points: self.points2
            width: 2
        Line:
            points: self.points3
            width: 2
        Line:
            points: self.points4
            width: 2

        # Channel frames
        Color:
            rgba: 1, 1, 1, 1

        Line:
            points: ((0, root.height * .2), (root.width, root.height * .2))

        Line:
            points: ((root.width * .2, 0), (root.width * 0.2, root.height * .2))

        Line:
            points: ((root.width * .4, 0), (root.width * 0.4, root.height * .2))

        Line:
            points: ((root.width * .6, 0), (root.width * 0.6, root.height * .2))

        Line:
            points: ((root.width * .8, 0), (root.width * 0.8, root.height * .2))


    cursor: mouse_cursor

    # cA/B Labels
    Label:
        font_size: 40
        center_x: root.width * 1 / 4
        top: root.top - 5
        text: "cA: " + str(root.str_cA)

    Label:
        font_size: 40
        center_y: root.height * .5
        x: 5
        canvas.before:
            PushMatrix
            Rotate:
                angle: 90
                origin: self.center
        canvas.after:
            PopMatrix
        text: "cB: " + str(root.str_cB)

    # eA/B labels:
    Label:
        font_size: 40
        center_x: root.width * 3 / 4
        top: root.top - 5
        text: "eA: " + str(root.str_eA)

    Label:
        font_size: 40
        center_y: root.height * .5
        x: 5 + root.width * .5
        canvas.before:
            PushMatrix
            Rotate:
                angle: 90
                origin: self.center
        canvas.after:
            PopMatrix
        text: "eB: " + str(root.str_eB)

    Label:
        font_size: 40
        center_x: root.width / 2
        bottom: 5
        text: root.pause_text

    Cursor:
        id: mouse_cursor
        center: self.parent.center

<Cursor>:
    size: 10, 10
    canvas:
        Ellipse:
            pos: self.pos
            size: self.size